/*!
 AutoFill 2.1.1
 Â©2008-2015 SpryMedia Ltd - datatables.net/license
*/

!function(t){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(e){return t(e,window,document)}):"object"==typeof exports?module.exports=function(e,o){return e||(e=window),o&&o.fn.dataTable||(o=require("datatables.net")(e,o).$),t(o,e,e.document)}:t(jQuery,window,document)}(function(t,e,o,l){var i=t.fn.dataTable,n=0,s=function(e,o){if(!i.versionCheck||!i.versionCheck("1.10.8"))throw"Warning: AutoFill requires DataTables 1.10.8 or greater";this.c=t.extend(!0,{},i.defaults.autoFill,s.defaults,o),this.s={dt:new i.Api(e),namespace:".autoFill"+n++,scroll:{},scrollInterval:null,handle:{height:0,width:0}},this.dom={handle:t('<div class="dt-autofill-handle"/>'),select:{top:t('<div class="dt-autofill-select top"/>'),right:t('<div class="dt-autofill-select right"/>'),bottom:t('<div class="dt-autofill-select bottom"/>'),left:t('<div class="dt-autofill-select left"/>')},background:t('<div class="dt-autofill-background"/>'),list:t('<div class="dt-autofill-list">'+this.s.dt.i18n("autoFill.info","")+"<ul/></div>"),dtScroll:null,offsetParent:null},this._constructor()};return t.extend(s.prototype,{_constructor:function(){var e=this,l=this.s.dt,i=t("div.dataTables_scrollBody",this.s.dt.table().container());i.length&&(this.dom.dtScroll=i,"static"===i.css("position")&&i.css("position","relative")),this._focusListener(),this.dom.handle.on("mousedown",function(t){return e._mousedown(t),!1}),l.on("destroy.autoFill",function(){l.off(".autoFill"),t(l.table().body()).off(e.s.namespace),t(o.body).off(e.s.namespace)})},_attach:function(e){var o=this.s.dt,l=o.cell(e).index(),i=this.dom.handle,n=this.s.handle,s=t("div.dataTables_scrollBody",this.s.dt.table().container());l&&-1!==o.columns(this.c.columns).indexes().indexOf(l.column)?(this.dom.offsetParent||(this.dom.offsetParent=t(e).offsetParent()),n.height&&n.width||(i.appendTo("body"),n.height=i.outerHeight(),n.width=i.outerWidth()),o=t(e).position(),this.dom.attachedTo=e,i.css({top:o.top+e.offsetHeight-n.height+s.scrollTop(),left:o.left+e.offsetWidth-n.width+s.scrollLeft()}).appendTo(this.dom.offsetParent)):this._detach()},_actionSelector:function(e){var o=this,l=this.s.dt,i=s.actions,n=[];if(t.each(i,function(t,o){o.available(l,e)&&n.push(t)}),1===n.length&&!1===this.c.alwaysAsk){var a=i[n[0]].execute(l,e);this._update(a,e)}else{var r=this.dom.list.children("ul").empty();n.push("cancel"),t.each(n,function(n,a){r.append(t("<li/>").append('<div class="dt-autofill-question">'+i[a].option(l,e)+"<div>").append(t('<div class="dt-autofill-button">').append(t('<button class="'+s.classes.btn+'">'+l.i18n("autoFill.button","&gt;")+"</button>").on("click",function(){var n=i[a].execute(l,e,t(this).closest("li"));o._update(n,e),o.dom.background.remove(),o.dom.list.remove()}))))}),this.dom.background.appendTo("body"),this.dom.list.appendTo("body"),this.dom.list.css("margin-top",-1*(this.dom.list.outerHeight()/2))}},_detach:function(){this.dom.attachedTo=null,this.dom.handle.detach()},_drawSelection:function(e){var o=this.s.dt,l=this.s.start,i=t(this.dom.start),n=t(e),s={row:o.rows({page:"current"}).nodes().indexOf(n.parent()[0]),column:n.index()};if(o.cell(n).any()&&-1!==o.columns(this.c.columns).indexes().indexOf(s.column)){this.s.end=s;var a,o=l.row<s.row?i:n;a=l.row<s.row?n:i,e=l.column<s.column?i:n,i=l.column<s.column?n:i,o=o.position().top,e=e.position().left,l=a.position().top+a.outerHeight()-o,i=i.position().left+i.outerWidth()-e,(n=this.dom.dtScroll)&&(o+=n.scrollTop(),e+=n.scrollLeft()),n=this.dom.select,n.top.css({top:o,left:e,width:i}),n.left.css({top:o,left:e,height:l}),n.bottom.css({top:o+l,left:e,width:i}),n.right.css({top:o,left:e+i,height:l})}},_editor:function(t){var e=this.s.dt,o=this.c.editor;if(o){for(var i={},n=[],s=o.fields(),a=0,r=t.length;a<r;a++)for(var d=0,c=t[a].length;d<c;d++){var u=t[a][d],h=e.settings()[0].aoColumns[u.index.column],f=h.editField;if(f===l)for(var h=h.mData,p=0,m=s.length;p<m;p++){var v=o.field(s[p]);if(v.dataSrc()===h){f=v.name();break}}if(!f)throw"Could not automatically determine field data. Please see https://datatables.net/tn/11";i[f]||(i[f]={}),h=e.row(u.index.row).id(),i[f][h]=u.set,n.push(u.index)}o.bubble(n,!1).multiSet(i).submit()}},_emitEvent:function(e,o){this.s.dt.iterator("table",function(l){t(l.nTable).triggerHandler(e+".dt",o)})},_focusListener:function(){var e=this,l=this.s.dt,i=this.s.namespace,n=null!==this.c.focus?this.c.focus:l.settings()[0].keytable?"focus":"hover";"focus"===n?l.on("key-focus.autoFill",function(t,o,l){e._attach(l.node())}).on("key-blur.autoFill",function(){e._detach()}):"click"===n?(t(l.table().body()).on("click"+i,"td, th",function(){e._attach(this)}),t(o.body).on("click"+i,function(o){t(o.target).parents().filter(l.table().body()).length||e._detach()})):t(l.table().body()).on("mouseenter"+i,"td, th",function(){e._attach(this)}).on("mouseleave"+i,function(o){t(o.relatedTarget).hasClass("dt-autofill-handle")||e._detach()})},_mousedown:function(l){var i=this,n=this.s.dt;this.dom.start=this.dom.attachedTo,this.s.start={row:n.rows({page:"current"}).nodes().indexOf(t(this.dom.start).parent()[0]),column:t(this.dom.start).index()},t(o.body).on("mousemove.autoFill",function(t){i._mousemove(t)}).on("mouseup.autoFill",function(t){i._mouseup(t)});var n=this.dom.select,s=t(this.s.dt.table().body()).offsetParent();n.top.appendTo(s),n.left.appendTo(s),n.right.appendTo(s),n.bottom.appendTo(s),this._drawSelection(this.dom.start,l),this.dom.handle.css("display","none"),l=this.dom.dtScroll,this.s.scroll={windowHeight:t(e).height(),windowWidth:t(e).width(),dtTop:l?l.offset().top:null,dtLeft:l?l.offset().left:null,dtHeight:l?l.outerHeight():null,dtWidth:l?l.outerWidth():null}},_mousemove:function(t){var e=t.target.nodeName.toLowerCase();"td"!==e&&"th"!==e||(this._drawSelection(t.target,t),this._shiftScroll(t))},_mouseup:function(){t(o.body).off(".autoFill");var e=this.s.dt,i=this.dom.select;i.top.remove(),i.left.remove(),i.right.remove(),i.bottom.remove(),this.dom.handle.css("display","block");var i=this.s.start,n=this.s.end;if(i.row!==n.row||i.column!==n.column){for(var s=this._range(i.row,n.row),i=this._range(i.column,n.column),n=[],a=e.settings()[0],r=a.aoColumns,d=0;d<s.length;d++)n.push(t.map(i,function(t){var t=e.cell(":eq("+s[d]+")",t+":visible",{page:"current"}),o=t.data(),i=t.index(),n=r[i.column].editField;return n!==l&&(o=a.oApi._fnGetObjectDataFn(n)(e.row(i.row).data())),{cell:t,data:o,label:t.data(),index:i}}));this._actionSelector(n),clearInterval(this.s.scrollInterval),this.s.scrollInterval=null}},_range:function(t,e){var o,l=[];if(t<=e)for(o=t;o<=e;o++)l.push(o);else for(o=t;o>=e;o--)l.push(o);return l},_shiftScroll:function(t){var e,l,i,n,s=this,a=this.s.scroll,r=!1,d=t.pageY-o.body.scrollTop,c=t.pageX-o.body.scrollLeft;65>d?e=-5:d>a.windowHeight-65&&(e=5),65>c?l=-5:c>a.windowWidth-65&&(l=5),null!==a.dtTop&&t.pageY<a.dtTop+65?i=-5:null!==a.dtTop&&t.pageY>a.dtTop+a.dtHeight-65&&(i=5),null!==a.dtLeft&&t.pageX<a.dtLeft+65?n=-5:null!==a.dtLeft&&t.pageX>a.dtLeft+a.dtWidth-65&&(n=5),e||l||i||n?(a.windowVert=e,a.windowHoriz=l,a.dtVert=i,a.dtHoriz=n,r=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null),!this.s.scrollInterval&&r&&(this.s.scrollInterval=setInterval(function(){if(a.windowVert&&(o.body.scrollTop=o.body.scrollTop+a.windowVert),a.windowHoriz&&(o.body.scrollLeft=o.body.scrollLeft+a.windowHoriz),a.dtVert||a.dtHoriz){var t=s.dom.dtScroll[0];a.dtVert&&(t.scrollTop=t.scrollTop+a.dtVert),a.dtHoriz&&(t.scrollLeft=t.scrollLeft+a.dtHoriz)}},20))},_update:function(t,e){if(!1!==t){var o,l=this.s.dt;if(this._emitEvent("preAutoFill",[l,e]),this._editor(e),null!==this.c.update?this.c.update:!this.c.editor){for(var i=0,n=e.length;i<n;i++)for(var s=0,a=e[i].length;s<a;s++)o=e[i][s],o.cell.data(o.set);l.draw(!1)}this._emitEvent("autoFill",[l,e])}}}),s.actions={increment:{available:function(e,o){return t.isNumeric(o[0][0].label)},option:function(t){return t.i18n("autoFill.increment",'Increment / decrement each cell by: <input type="number" value="1">')},execute:function(e,o,l){for(var e=1*o[0][0].data,l=1*t("input",l).val(),i=0,n=o.length;i<n;i++)for(var s=0,a=o[i].length;s<a;s++)o[i][s].set=e,e+=l}},fill:{available:function(){return!0},option:function(t,e){return t.i18n("autoFill.fill","Fill all cells with <i>"+e[0][0].label+"</i>")},execute:function(t,e){for(var o=e[0][0].data,l=0,i=e.length;l<i;l++)for(var n=0,s=e[l].length;n<s;n++)e[l][n].set=o}},fillHorizontal:{available:function(t,e){return 1<e.length&&1<e[0].length},option:function(t){return t.i18n("autoFill.fillHorizontal","Fill cells horizontally")},execute:function(t,e){for(var o=0,l=e.length;o<l;o++)for(var i=0,n=e[o].length;i<n;i++)e[o][i].set=e[o][0].data}},fillVertical:{available:function(t,e){return 1<e.length&&1<e[0].length},option:function(t){return t.i18n("autoFill.fillVertical","Fill cells vertically")},execute:function(t,e){for(var o=0,l=e.length;o<l;o++)for(var i=0,n=e[o].length;i<n;i++)e[o][i].set=e[0][i].data}},cancel:{available:function(){return!1},option:function(t){return t.i18n("autoFill.cancel","Cancel")},execute:function(){return!1}}},s.version="2.1.1",s.defaults={alwaysAsk:!1,focus:null,columns:"",update:null,editor:null},s.classes={btn:"btn"},t(o).on("preInit.dt.autofill",function(e,o){if("dt"===e.namespace){var l=o.oInit.autoFill,n=i.defaults.autoFill;(l||n)&&(n=t.extend({},l,n),!1!==l&&new s(o,n))}}),i.AutoFill=s,i.AutoFill=s});