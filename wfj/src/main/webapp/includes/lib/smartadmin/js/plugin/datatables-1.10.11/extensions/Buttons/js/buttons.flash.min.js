!function(e){"function"==typeof define&&define.amd?define(["jquery","datatables.net","datatables.net-buttons"],function(t){return e(t,window,document)}):"object"==typeof exports?module.exports=function(t,i){return t||(t=window),i&&i.fn.dataTable||(i=require("datatables.net")(t,i).$),i.fn.dataTable.Buttons||require("datatables.net-buttons")(t,i),e(i,t,t.document)}:e(jQuery,window,document)}(function(e,t,i,s){var n=e.fn.dataTable,o={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(e){return"string"==typeof e&&(e=i.getElementById(e)),e.addClass||(e.hide=function(){this.style.display="none"},e.show=function(){this.style.display=""},e.addClass=function(e){this.removeClass(e),this.className+=" "+e},e.removeClass=function(e){this.className=this.className.replace(RegExp("\\s*"+e+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")},e.hasClass=function(e){return!!this.className.match(RegExp("\\s*"+e+"\\s*"))}),e},setMoviePath:function(e){this.moviePath=e},dispatch:function(e,t,i){(e=this.clients[e])&&e.receiveEvent(t,i)},register:function(e,t){this.clients[e]=t},getDOMObjectPosition:function(e){var t={left:0,top:0,width:e.width?e.width:e.offsetWidth,height:e.height?e.height:e.offsetHeight};for(""!==e.style.width&&(t.width=e.style.width.replace("px","")),""!==e.style.height&&(t.height=e.style.height.replace("px",""));e;)t.left+=e.offsetLeft,t.top+=e.offsetTop,e=e.offsetParent;return t},Client:function(e){this.handlers={},this.id=o.nextId++,this.movieId="ZeroClipboard_TableToolsMovie_"+this.id,o.register(this.id,this),e&&this.glue(e)}};o.Client.prototype={id:0,ready:!1,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:!0,cssEffects:!0,handlers:null,sized:!1,sheetName:"",glue:function(e,t){this.domElement=o.$(e);var s=99;this.domElement.style.zIndex&&(s=parseInt(this.domElement.style.zIndex,10)+1);var n=o.getDOMObjectPosition(this.domElement);this.div=i.createElement("div");var a=this.div.style;a.position="absolute",a.left="0px",a.top="0px",a.width=n.width+"px",a.height=n.height+"px",a.zIndex=s,"undefined"!=typeof t&&""!==t&&(this.div.title=t),0!==n.width&&0!==n.height&&(this.sized=!0),this.domElement&&(this.domElement.appendChild(this.div),this.div.innerHTML=this.getHTML(n.width,n.height).replace(/&/g,"&amp;"))},positionElement:function(){var e=o.getDOMObjectPosition(this.domElement),t=this.div.style;t.position="absolute",t.width=e.width+"px",t.height=e.height+"px",0!==e.width&&0!==e.height&&(this.sized=!0,t=this.div.childNodes[0],t.width=e.width,t.height=e.height)},getHTML:function(e,t){var i="",s="id="+this.id+"&width="+e+"&height="+t;if(navigator.userAgent.match(/MSIE/))var n=location.href.match(/^https/i)?"https://":"http://",i=i+('<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+n+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+e+'" height="'+t+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+o.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+s+'"/><param name="wmode" value="transparent"/></object>');else i+='<embed id="'+this.movieId+'" src="'+o.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+e+'" height="'+t+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+s+'" wmode="transparent" />';return i},hide:function(){this.div&&(this.div.style.left="-2000px")},show:function(){this.reposition()},destroy:function(){var t=this;this.domElement&&this.div&&(e(this.div).remove(),this.div=this.domElement=null,e.each(o.clients,function(e,i){i===t&&delete o.clients[e]}))},reposition:function(e){if(e&&((this.domElement=o.$(e))||this.hide()),this.domElement&&this.div){var e=o.getDOMObjectPosition(this.domElement),t=this.div.style;t.left=""+e.left+"px",t.top=""+e.top+"px"}},clearText:function(){this.clipText="",this.ready&&this.movie.clearText()},appendText:function(e){this.clipText+=e,this.ready&&this.movie.appendText(e)},setText:function(e){this.clipText=e,this.ready&&this.movie.setText(e)},setFileName:function(e){this.fileName=e,this.ready&&this.movie.setFileName(e)},setSheetName:function(e){this.sheetName=e,this.ready&&this.movie.setSheetName(e)},setAction:function(e){this.action=e,this.ready&&this.movie.setAction(e)},addEventListener:function(e,t){e=e.toString().toLowerCase().replace(/^on/,""),this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)},setHandCursor:function(e){this.handCursorEnabled=e,this.ready&&this.movie.setHandCursor(e)},setCSSEffects:function(e){this.cssEffects=!!e},receiveEvent:function(e,s){var n,e=e.toString().toLowerCase().replace(/^on/,"");switch(e){case"load":if(this.movie=i.getElementById(this.movieId),!this.movie)return n=this,void setTimeout(function(){n.receiveEvent("load",null)},1);if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/))return n=this,setTimeout(function(){n.receiveEvent("load",null)},100),void(this.ready=!0);this.ready=!0,this.movie.clearText(),this.movie.appendText(this.clipText),this.movie.setFileName(this.fileName),this.movie.setAction(this.action),this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":this.domElement&&this.cssEffects&&this.recoverActive&&this.domElement.addClass("active");break;case"mouseout":this.domElement&&this.cssEffects&&(this.recoverActive=!1,this.domElement.hasClass("active")&&(this.domElement.removeClass("active"),this.recoverActive=!0));break;case"mousedown":this.domElement&&this.cssEffects&&this.domElement.addClass("active");break;case"mouseup":this.domElement&&this.cssEffects&&(this.domElement.removeClass("active"),this.recoverActive=!1)}if(this.handlers[e])for(var o=0,a=this.handlers[e].length;o<a;o++){var r=this.handlers[e][o];"function"==typeof r?r(this,s):"object"==typeof r&&2==r.length?r[0][r[1]](this,s):"string"==typeof r&&t[r](this,s)}}},o.hasFlash=function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(e){if(navigator.mimeTypes&&navigator.mimeTypes["application/x-shockwave-flash"]!==s&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},t.ZeroClipboard_TableTools=o;var a=function(e,t){t.attr("id"),t.parents("html").length?e.glue(t[0],""):setTimeout(function(){a(e,t)},500)},r=function(t,i){var n="*"===t.filename&&"*"!==t.title&&t.title!==s?t.title:t.filename;return"function"==typeof n&&(n=n()),-1!==n.indexOf("*")&&(n=n.replace("*",e("title").text())),n=n.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,""),i===s||!0===i?n+t.extension:n},l=function(e){var t="Sheet1";return e.sheetName&&(t=e.sheetName.replace(/[\[\]\*\/\\\?\:]/g,"")),t},h=function(t){return t=t.title,"function"==typeof t&&(t=t()),-1!==t.indexOf("*")?t.replace("*",e("title").text()):t},c=function(e,t){var i=t.match(/[\s\S]{1,8192}/g)||[];e.clearText();for(var s=0,n=i.length;s<n;s++)e.appendText(i[s])},d=function(e,t){for(var i=t.newline?t.newline:navigator.userAgent.match(/Windows/)?"\r\n":"\n",n=e.buttons.exportData(t.exportOptions),o=t.fieldBoundary,a=t.fieldSeparator,r=RegExp(o,"g"),l=t.escapeChar!==s?t.escapeChar:"\\",h=function(e){for(var t="",i=0,s=e.length;i<s;i++)0<i&&(t+=a),t+=o?o+(""+e[i]).replace(r,l+o)+o:e[i];return t},c=t.header?h(n.header)+i:"",d=t.footer&&n.footer?i+h(n.footer):"",f=[],u=0,m=n.body.length;u<m;u++)f.push(h(n.body[u]));return{str:c+f.join(i)+d,rows:f.length}},f={available:function(){return o.hasFlash()},init:function(e,t,i){o.moviePath=n.Buttons.swfPath;var s=new o.Client;s.setHandCursor(!0),s.addEventListener("mouseDown",function(){i._fromFlash=!0,e.button(t[0]).trigger(),i._fromFlash=!1}),a(s,t),i._flash=s},destroy:function(e,t,i){i._flash.destroy()},fieldSeparator:",",fieldBoundary:'"',exportOptions:{},title:"*",filename:"*",extension:".csv",header:!0,footer:!1};return n.Buttons.swfPath="//cdn.datatables.net/buttons/1.0.0/swf/flashExport.swf",n.Api.register("buttons.resize()",function(){e.each(o.clients,function(e,t){t.domElement!==s&&t.domElement.parentNode&&t.positionElement()})}),n.ext.buttons.copyFlash=e.extend({},f,{className:"buttons-copy buttons-flash",text:function(e){return e.i18n("buttons.copy","Copy")},action:function(e,t,i,s){s._fromFlash&&(e=s._flash,i=d(t,s),s=s.customize?s.customize(i.str,s):i.str,e.setAction("copy"),c(e,s),t.buttons.info(t.i18n("buttons.copyTitle","Copy to clipboard"),t.i18n("buttons.copyInfo",{_:"Copied %d rows to clipboard",1:"Copied 1 row to clipboard"},i.rows),3e3))},fieldSeparator:"\t",fieldBoundary:""}),n.ext.buttons.csvFlash=e.extend({},f,{className:"buttons-csv buttons-flash",text:function(e){return e.i18n("buttons.csv","CSV")},action:function(e,t,i,s){e=s._flash,t=d(t,s),t=s.customize?s.customize(t.str,s):t.str,e.setAction("csv"),e.setFileName(r(s)),c(e,t)},escapeChar:'"'}),n.ext.buttons.excelFlash=e.extend({},f,{className:"buttons-excel buttons-flash",text:function(e){return e.i18n("buttons.excel","Excel")},action:function(t,i,n,o){var t="",n=o._flash,i=i.buttons.exportData(o.exportOptions),a=function(t){for(var i=[],n=0,o=t.length;n<o;n++)null!==t[n]&&t[n]!==s||(t[n]=""),i.push("number"==typeof t[n]||t[n].match&&e.trim(t[n]).match(/^-?\d+(\.\d+)?$/)&&"0"!==t[n].charAt(0)?'<c t="n"><v>'+t[n]+"</v></c>":'<c t="inlineStr"><is><t>'+(t[n].replace?t[n].replace(/&(?!amp;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/[\x00-\x1F\x7F-\x9F]/g,""):t[n])+"</t></is></c>");return"<row>"+i.join("")+"</row>"};o.header&&(t+=a(i.header));for(var h=0,d=i.body.length;h<d;h++)t+=a(i.body[h]);o.footer&&(t+=a(i.footer)),n.setAction("excel"),n.setFileName(r(o)),n.setSheetName(l(o)),c(n,t)},extension:".xlsx"}),n.ext.buttons.pdfFlash=e.extend({},f,{className:"buttons-pdf buttons-flash",text:function(e){return e.i18n("buttons.pdf","PDF")},action:function(e,t,i,s){var e=s._flash,i=t.buttons.exportData(s.exportOptions),n=t.table().node().offsetWidth,o=t.columns(s.columns).indexes().map(function(e){return t.column(e).header().offsetWidth/n});e.setAction("pdf"),e.setFileName(h(s)),c(e,JSON.stringify({title:r(s,!1),message:s.message,colWidth:o.toArray(),orientation:s.orientation,size:s.pageSize,header:s.header?i.header:null,footer:s.footer?i.footer:null,body:i.body}))},extension:".pdf",orientation:"portrait",pageSize:"A4",message:"",newline:"\n"}),n.Buttons});