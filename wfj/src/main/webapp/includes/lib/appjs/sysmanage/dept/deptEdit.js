define(["basetools"],function(e){var t=function(t){var a=!1;$("#deptedit_form input,textarea").change(function(){a=!0}),$.restAjax({url:$.apiPath+moduleName.dept+$.apijoin+"departments"+$.apijoin+$("#departmentcode").val(),type:"get",cache:!1,success:function(e){"200"==e.status&&"OK"==e.code&&$("#deptedit_form").json2form({data:e.result})}}),$("#deptedit_form").validate({errorElement:"em",errorContainer:"#errordiv",errorLabelContainer:"#errortip",rules:{departmentName:{required:!0,maxlength:8,isGB18030:!0},description:{maxlength:20}},messages:{departmentName:{required:" 请输入部门名称；",maxlength:" 部门名称不能超过8个字符；",isGB18030:"部门名称只能输入汉字；"},description:{maxlength:" 说明不能超过20个字符；"}},submitHandler:function(a){var n=$("#deptedit_form").form2json();$.restAjax({url:$.apiPath+moduleName.dept+$.apijoin+"departments",type:"PUT",dataType:"json",data:n,async:!1,success:function(a){"200"==a.status&&"OK"==a.code?($("li#"+$("#departmentcode").val()).find(">span").html($("li#"+$("#departmentcode").val()).find(">span > i").get(0).outerHTML+"&nbsp;"+$("#departmentname").val()),$("#deptedit_close").click(),$("#dept_table").dataTable().fnUpdate(a.result,t,null,!1),e.backTip(a,"Y")):e.backTip(a,"N")}})}}),$("#deptedit_cancel").click(function(){a?$.confirm({title:"确认信息",content:"确认取消当前所做的操作",confirmButton:"是",cancelButton:"否",confirm:function(){$("#deptedit_close").click()}}):$("#deptedit_close").click()})};return{init:t}});